# üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API - –°–µ—Ä–≤–∏—Å—ã OCR –∏ –ß–∞—Ç–∞ (Gemini, Grok, Cloud Vision)

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏ OCR Gemini, OCR Grok Vision –∏ OCR Cloud Vision.

## ‚ÑπÔ∏è –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ë–∞–∑–æ–≤—ã–µ URL (–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ Docker Compose)

*   **OCR Gemini Service:** `http://localhost:8000`
*   **OCR Grok Vision Service:** `http://localhost:8001`
*   **OCR Cloud Vision Service:** `http://localhost:8002`

*(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–∏ –ø–æ—Ä—Ç—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è)*

### üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

*   **–°–µ—Ä–≤–∏—Å—ã Gemini & Grok:** –≠—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–∞ API —á–µ—Ä–µ–∑ HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key` (Google API Key –¥–ª—è Gemini, XAI API Key –¥–ª—è Grok). –ï—Å–ª–∏ –∫–ª—é—á API –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ —Ñ–∞–π–ª–µ `.env` —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞, –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–ª—é—á API –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.
*   **–°–µ—Ä–≤–∏—Å Cloud Vision:** –≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Google Cloud Application Default Credentials (ADC). –û–±—ã—á–Ω–æ —ç—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `GOOGLE_APPLICATION_CREDENTIALS` –≤ —Å—Ä–µ–¥–µ —Å–µ—Ä–≤–∏—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env` –∏ Docker Compose), —É–∫–∞–∑—ã–≤–∞—é—â–µ–π –Ω–∞ —Ñ–∞–π–ª –∫–ª—é—á–∞ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ ADC –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## ‚ôä 1. OCR Gemini Service

**–ë–∞–∑–æ–≤—ã–π URL:** `http://localhost:8000`

### üì∏ 1.1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (OCR)

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `POST /ocr/extract-text`
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ Gemini Vision.
*   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):**
    *   `X-API-Key`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) Google API Key.
*   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body):** `multipart/form-data`
    *   `file`: (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã: `image/jpeg`, `image/png`, `image/webp`, `image/heic`, `image/heif`).
*   **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (Query Parameters):**
    *   `prompt`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –¢–µ–∫—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ò–∑–≤–ª–µ—á—å —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å"). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≤–µ—Å—å —Ç–µ–∫—Å—Ç.
    *   `model_name`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ò–º—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ Gemini Vision –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gemini-2.0-flash-exp-image-generation`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`GEMINI_VISION_MODEL_NAME`).
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    ```json
    {
      "filename": "–∏–º—è_—Ñ–∞–π–ª–∞_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.jpg",
      "content_type": "image/jpeg",
      "extracted_text": "–ò–∑–≤–ª–µ—á–µ–Ω–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ...",
      "model_used": "gemini-2.0-flash-exp-image-generation" // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    }
    ```
*   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `application/json` (–ü—Ä–∏–º–µ—Ä—ã: 400, 422, 500, 503)
    ```json
    {
      "detail": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏..."
    }
    ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X POST "http://localhost:8000/ocr/extract-text?prompt=Extract%20only%20the%20invoice%20number&model_name=gemini-2.0-flash-exp-image-generation" \
         -H "X-API-Key: YOUR_GOOGLE_API_KEY" \
         -F "file=@/–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.png"
    ```

### üí¨ 1.2. –¢–µ–∫—Å—Ç–æ–≤—ã–π —á–∞—Ç (Chat)

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `POST /chat/`
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏ Gemini Text.
*   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):**
    *   `Content-Type`: `application/json`
    *   `X-API-Key`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) Google API Key.
*   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body):** `application/json`
    ```json
    {
      "message": "–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "history": [
        {"role": "user", "content": "–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"},
        {"role": "assistant", "content": "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏"}
        // ... –¥—Ä—É–≥–∏–µ —Ä–µ–ø–ª–∏–∫–∏
      ],
      "model_name": "gemini-2.0-flash" // –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞–ø—Ä., –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å flash –¥–ª—è —á–∞—Ç–∞)
    }
    ```
    *   `message`: (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   `history`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. `role` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `"user"` –∏–ª–∏ `"assistant"`.
    *   `model_name`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ò–º—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ Gemini Text –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gemini-2.0-flash`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`GEMINI_TEXT_MODEL_NAME`).
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    ```json
    {
      "response_text": "–û—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏ Gemini...",
      "model_used": "gemini-2.0-flash" // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    }
    ```
*   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `application/json` (–ü—Ä–∏–º–µ—Ä—ã: 400, 500, 503)
    ```json
    {
      "detail": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏..."
    }
    ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X POST "http://localhost:8000/chat/" \
         -H "Content-Type: application/json" \
         -H "X-API-Key: YOUR_GOOGLE_API_KEY" \
         -d '{
               "message": "–ö–∞–∫–∞—è —Å—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏?",
               "history": [
                 {"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç"},
                 {"role": "assistant", "content": "–ü—Ä–∏–≤–µ—Ç!"}
               ],
               "model_name": "gemini-2.0-flash"
             }'
    ```

---

## ü§ñ 2. OCR Grok Vision Service

**–ë–∞–∑–æ–≤—ã–π URL:** `http://localhost:8001`

### üì∏ 2.1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (OCR)

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `POST /ocr/extract-text`
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ Grok Vision.
*   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):**
    *   `X-API-Key`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) XAI API Key.
*   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body):** `multipart/form-data`
    *   `file`: (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã: `image/jpeg`, `image/png`).
*   **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (Query Parameters):**
    *   `prompt`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –¢–µ–∫—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª—å—é. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –≤–µ—Å—å —Ç–µ–∫—Å—Ç.
    *   `model_name`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ò–º—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ Grok Vision –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `grok-2-vision-1212`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`GROK_VISION_DEFAULT_MODEL`).
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    ```json
    {
      "filename": "–∏–º—è_—Ñ–∞–π–ª–∞_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.jpg",
      "content_type": "image/jpeg",
      "extracted_text": "–ò–∑–≤–ª–µ—á–µ–Ω–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ...",
      "model_used": "grok-2-vision-1212" // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    }
    ```
*   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `application/json` (–ü—Ä–∏–º–µ—Ä—ã: 400, 415, 429, 500, 502, 503, 504)
    ```json
    {
      "detail": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏..."
    }
    ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X POST "http://localhost:8001/ocr/extract-text?model_name=grok-2-vision-1212" \
         -H "X-API-Key: YOUR_XAI_API_KEY" \
         -F "file=@/–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.jpg"
    ```

### üí¨ 2.2. –¢–µ–∫—Å—Ç–æ–≤—ã–π —á–∞—Ç (Chat)

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `POST /chat/`
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏ Grok Text.
*   **–ó–∞–≥–æ–ª–æ–≤–∫–∏ (Headers):**
    *   `Content-Type`: `application/json`
    *   `X-API-Key`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) XAI API Key.
*   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body):** `application/json`
    ```json
    {
      "message": "–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "history": [
        {"role": "user", "content": "–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"},
        {"role": "assistant", "content": "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏"}
        // ... –¥—Ä—É–≥–∏–µ —Ä–µ–ø–ª–∏–∫–∏
      ],
      "model_name": "grok-2-1212" // –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞–ø—Ä., –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å grok-2 –¥–ª—è —á–∞—Ç–∞)
    }
    ```
    *   `message`: (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   `history`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π. `role` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `"user"` –∏–ª–∏ `"assistant"`.
    *   `model_name`: (–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ò–º—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ Grok Text –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `grok-2-1212`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`GROK_TEXT_DEFAULT_MODEL`).
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    ```json
    {
      "response_text": "–û—Ç–≤–µ—Ç –æ—Ç –º–æ–¥–µ–ª–∏ Grok...",
      "model_used": "grok-2-1212" // –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    }
    ```
*   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `application/json` (–ü—Ä–∏–º–µ—Ä—ã: 400, 429, 500, 502, 503, 504)
    ```json
    {
      "detail": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏..."
    }
    ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X POST "http://localhost:8001/chat/" \
         -H "Content-Type: application/json" \
         -H "X-API-Key: YOUR_XAI_API_KEY" \
         -d '{
               "message": "–û–±—ä—è—Å–Ω–∏—Ç–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é zero-shot learning.",
               "history": [],
               "model_name": "grok-2-1212"
             }'
    ```

---

## ‚òÅÔ∏è 3. OCR Cloud Vision Service

**–ë–∞–∑–æ–≤—ã–π URL:** `http://localhost:8002`

### üì∏ 3.1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (OCR)

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `POST /ocr/extract-text`
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é Google Cloud Vision API.
*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Google Cloud Application Default Credentials (ADC), –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (—á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `GOOGLE_APPLICATION_CREDENTIALS`). –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
*   **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (Request Body):** `multipart/form-data`
    *   `file`: (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –§–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ JPEG, PNG, GIF, BMP, WEBP, RAW, ICO, PDF, TIFF - —Å–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Google Cloud Vision –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π).
*   **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ (Query Parameters):** –ù–µ—Ç.
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    ```json
    {
      "text": "–ü–æ–ª–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ...",
      "details": [
        {
          "text": "–°–ª–æ–≤–æ1",
          "bounding_box": [
            {"x": 10, "y": 10},
            {"x": 50, "y": 10},
            {"x": 50, "y": 30},
            {"x": 10, "y": 30}
          ]
        },
        {
          "text": "–°–ª–æ–≤–æ2",
          "bounding_box": [
            {"x": 60, "y": 10},
            {"x": 100, "y": 10},
            {"x": 100, "y": 30},
            {"x": 60, "y": 30}
          ]
        }
        // ... –¥—Ä—É–≥–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏
      ]
    }
    ```
*   **–û—Ç–≤–µ—Ç (–û—à–∏–±–∫–∞):** `application/json` (–ü—Ä–∏–º–µ—Ä—ã: 400, 403, 429, 500, 502)
    ```json
    {
      "detail": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'Permission denied: Check credentials/API key permissions...', 'API quota exceeded...', 'Invalid image format or content...', 'Upstream Google API Error:...')"
    }
    ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X POST "http://localhost:8002/ocr/extract-text" \
         -F "file=@/–ø—É—Ç—å/–∫/–≤–∞—à–µ–º—É/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.png"
    ```

---

## ‚úÖ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (Health Check)

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Ö —Ä–∞–±–æ—á–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

*   **–ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ (Endpoint):** `GET /health` (–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ë–µ–∑ –∫–æ—Å–æ–π —á–µ—Ä—Ç—ã –≤ –∫–æ–Ω—Ü–µ –¥–ª—è Cloud Vision)
*   **–û–ø–∏—Å–∞–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞.
*   **–û—Ç–≤–µ—Ç (–£—Å–ø–µ—Ö - 200 OK):** `application/json`
    *   *Gemini:*
        ```json
        {
          "status": "ok"
        }
        ```
    *   *Grok:*
        ```json
        {
          "status": "ok",
          "app_name": "OCR Grok Vision Service",
          "app_version": "1.0.0"
        }
        ```
    *   *Cloud Vision:*
        ```json
        {
          "status": "ok"
        }
        ```
*   **–ü—Ä–∏–º–µ—Ä (curl):**
    ```bash
    curl -X GET http://localhost:8000/health/
    curl -X GET http://localhost:8001/health/
    curl -X GET http://localhost:8002/health